---
title: "Role of institution and governance in the development"
author: "Elo√Øse Vannier"
format: pdf
execute:
  echo: false
  warning: false
---

```{r}
#| message: false
here::i_am("final_project.Rproj")
library(here)
library(vroom)
library(dplyr)
library(tidyr)
library(ggplot2)
library(tidyverse)
library(broom)
library(gridExtra)
```

```{r}
#| message: false
# Data loading :
govc_indicators <- vroom(here("data", "governance_indicators.csv"),na = (".."))
dvpt_indicators <- vroom(here("data", "development_indicators.csv"),na = (".."))

# Keeping only rows containing countries for which both data sets provide data :
govc_indicators = govc_indicators |> filter(nchar(`Country Code`)==3)
list_country = govc_indicators |> distinct (`Country Name`,`Country Code`)
dvpt_indicators = inner_join(list_country,dvpt_indicators,join_by(`Country Name`,`Country Code`))

# Changing the type of the values of the development indicators (perceived as characters before) :
dvpt_indicators <- dvpt_indicators |>  mutate(`2022 [YR2022]` = parse_double(`2022 [YR2022]`), `2021 [YR2021]` = parse_double(`2021 [YR2021]`),`2020 [YR2020]` = parse_double(`2020 [YR2020]`))

# Computing the mean of the three years to get one and only value for each indicators and have less NA :
mean.govc <- rowMeans((govc_indicators |> select(`2020 [YR2020]`,`2021 [YR2021]`, `2022 [YR2022]`)),na.rm = TRUE)
govc_indicators <- govc_indicators |> mutate("Mean"=mean.govc)
mean.dvpt <- rowMeans((dvpt_indicators |> select(`2020 [YR2020]`,`2021 [YR2021]`, `2022 [YR2022]`)),na.rm = TRUE)
dvpt_indicators <- dvpt_indicators |> mutate("Mean"=mean.dvpt)

# Saving the series' code in a separate dataframe and suppressing the "Series Code" column as well as the three "years column" in each dataframe :
govc_codes = govc_indicators |> distinct(`Series Name`,`Series Code`) 
dvpt_codes = dvpt_indicators |> distinct(`Series Name`,`Series Code`)

govc_indicators = govc_indicators |> select(-`Series Code`,-`2020 [YR2020]`,-`2021 [YR2021]`, -`2022 [YR2022]`)
dvpt_indicators = dvpt_indicators |> select(-`Series Code`,-`2020 [YR2020]`,-`2021 [YR2021]`, -`2022 [YR2022]`)

# Supressing the indicators providing data for less than 75% of the countries in our sample :
critic_minimum = 0.75*NROW(list_country)
keep.dvpt.indicator = " "
for (i in 1:NROW(dvpt_codes)) {
  df = dvpt_indicators |> filter(dvpt_indicators$`Series Name`== dvpt_codes$`Series Name`[i])
  if (sum(is.na(df$Mean)) < critic_minimum) {
    keep.dvpt.indicator = c(keep.dvpt.indicator,dvpt_codes$`Series Name`[i])
  }
}
keep.dvpt.indicator = as.data.frame(keep.dvpt.indicator) |>
  rename(`Series Name`=keep.dvpt.indicator)
dvpt_indicators <- inner_join(keep.dvpt.indicator,dvpt_indicators,join_by(`Series Name`))

keep.govc.indicator = " "
for (i in 1:NROW(govc_codes)) {
  df = govc_indicators |> filter(govc_indicators$`Series Name`== govc_codes$`Series Name`[i])
  if (sum(is.na(df$Mean)) < critic_minimum) {
    keep.govc.indicator = c(keep.govc.indicator,govc_codes$`Series Name`[i])
  }
}
keep.govc.indicator = as.data.frame(keep.govc.indicator) |>
  rename(`Series Name`=keep.govc.indicator)
govc_indicators <- inner_join(keep.govc.indicator,govc_indicators,join_by(`Series Name`))

# Joining the two dataframes :
wide_govc <- pivot_wider(govc_indicators, names_from = `Series Name`, values_from = Mean)
wide_dvpt <- pivot_wider(dvpt_indicators, names_from = `Series Name`, values_from = Mean)

global_df <- inner_join(wide_dvpt,wide_govc, join_by(`Country Name`,`Country Code`))

long_global_df <- pivot_longer(global_df, cols = `Access to electricity (% of population)`:`Voice and Accountability: Standard Error`, names_to = "Series Name", values_to = "Mean")
```

## I) Research question presentation

The goal of this project is to study the links between the governance of a country, and its development. 
The notion of development is interesting as it can approximate well-being. It encompasses economic aspects, as poverty has a negative impact on the happiness for sure. We will therefore try to find what variables are correlated to GDP as it is the most known and computed economic indicator to get hints of how to foster economic growth.
But development can't be limited to this economic lens. 
More and more economists, sociologist and philosophers highlight the limits of the GDP as indicator of well-being. Indeed, economic development alone may leads to disparities, leaving certain segments of the population marginalized. It is therefore crucial to take into account other dimensions of human development such as access to a good health system and education, or social inequalities. 
Since the robustness of legal frameworks, the violence and the protection of human rights can also impact economic growth and well-being (increasing a feeling of safety and justice for instance), it is logical to add governance aspects to this study.
Governance refers to the systems, structures, and processes by which a country is directed and controlled. It encompasses not only formal government institutions but also all practices that influence decision-making. Effective governance is a cornerstone of development, as it establishes the rules of the game, ensures accountability, and promotes transparency. The quality of governance profoundly influences a country's attractiveness to investors, the efficiency of public services, and the overall well-being of its citizens.
Therefore, understanding these links is crucial for designing effective policies, and fostering sustainable development.
The Human Development Index was developed by Mahbub ul Haq and Sen to measure development using not only the GDP per capita and purchasing power parity, but also health indicator with the life-expectancy, and education indicators. At the end of our study, we will try to compute another composite indicator encompassing the main development aspects we will have just seen.

## II) Data sets descriptions

## III) Data analysis

When we think about "development", we first think of economic growth. Indeed, as depicted in the following plot, economic growth has a negative and significant correlation with poverty. 
```{r}
pivot_longer(global_df,cols = c("Poverty headcount ratio at national poverty lines (% of population)","Poverty headcount ratio at $2.15 a day (2017 PPP) (% of population)","Prevalence of moderate or severe food insecurity in the population (%)"), names_to = "poverty estimates", values_to = "estimates value") |>
  ggplot(aes(x =`GDP per capita growth (annual %)`,y = `estimates value`)) + 
  geom_point(aes(color = `poverty estimates`,alpha=0.5))+geom_smooth(method = "lm", se = FALSE, col="black")+facet_wrap(~`poverty estimates`)+theme(legend.position = "bottom",legend.direction="vertical")
```

If we want to improve the situation of developing countries, we must then try to foster growth. But how can we go that ? What parameters play a role in economic growth ?
While trying to explain economic growth, Sollow acknowledged two factors of production : capital and labor. The "residual" he obtained once he took those factors into account was significant and attributed to the productivity of the production factors. Several variables of the data set can indicate productivity : the HCI index computed by the World Bank for females, males and the total population, and the number of researchers in R&D per million people. As mentioned earlier the HCI was computed precisely to estimates the productivity of workers of tomorrow, and the more researchers there is, the more likely they will find new innovation that will possibly increase capital and/or labor productivity.
Let's check if our data go along with those hints :

```{r}
plot.HCI.growth <- ggplot(global_df, aes(x =`GDP per capita growth (annual %)`, y = `Human capital index (HCI) (scale 0-1)`))+geom_point()+geom_smooth(method = "lm", se = FALSE, col = "red")
```
```{r}
plot.HCI.GDP <- pivot_longer(global_df,cols = c("Human capital index (HCI) (scale 0-1)","Human capital index (HCI), female (scale 0-1)","Human capital index (HCI), male (scale 0-1)"), 
                        names_to = "HCI", 
                        values_to = "HCI value") |>
  ggplot(aes(x =`GDP per capita, PPP (current international $)`,y = `HCI value`, group = HCI)) + geom_point(aes(color = HCI))+ theme(legend.position = "bottom",legend.direction="vertical")
grid.arrange(plot.HCI.GDP, plot.HCI.growth, ncol = 2)
```
These two first graphs show a slightly positive correlation between the HCI and the GDP growth, and a positive but decreasing relationship between the HCI and the GDP per capita taking into account the parity of purchasing power. We can also note that the HCI is higher for females than for males : that means that there is more chance for a girl than for a boy born between 2020 and 2022 to become as productive as they would if they enjoyed full health and complete education when they will grow up. 

```{r}
plot.GDP.RD <- ggplot(global_df, aes(x =`GDP per capita, PPP (current international $)`, y = `Researchers in R&D (per million people)`))+geom_point()+geom_smooth(method = "lm", se = FALSE, col = "red")
plot.growth.RD <- ggplot(global_df, aes(x =`GDP per capita growth (annual %)`, y = `Researchers in R&D (per million people)`))+geom_point()+geom_smooth(method = "lm", se = FALSE, col = "red")
grid.arrange(plot.GDP.RD, plot.growth.RD, ncol = 2)
```
The two graphs right above show a positive and quite linear correlation between the number of researchers per million and the GDP per capita taking into account the parity of purchasing power. The relationship between the number of researchers and the economic growth is far less clear.
Of course those four graphs are not sufficient to deduce a causal relationship between those variables, especially to see the links between HCI or the number of researchers per million people and economic growth. Indeed since those variable are supposed to impact future growth we would need either the past number of researchers per million people and the HCI level of at least 20 years ago, or the future economic growth to see the eventual impacts. But since the corresponding data are not available, those results are still interesting : they at least do not seem not contradict our hypotheses.

Another common variable used to explain economic growth is the investment (again to increase productivity via innovation for example). Foreign Direct Investment impacts on growth are very discussed in economic literature, many arguments are both in favor and against FDI positive impacts on growth. For instance FDI could have positive knowledge and technological spillover on host country, but could also evict local firm in a way that just make profit leave the host country. The two following graphs shows that there are no significantly positive or negative correlation between FDI net inflows and outflows and GDP per capita growth.
```{r}
pivot_longer(global_df,cols = c("Foreign direct investment, net outflows (% of GDP)","Foreign direct investment, net inflows (% of GDP)"), names_to = "FDI", values_to = "FDI value") |>
  ggplot(aes(x =`GDP per capita growth (annual %)`,y = `FDI value`)) + 
  geom_point(aes(color = FDI,alpha=0.5))+geom_smooth(method = "lm", se = FALSE, col="black")+facet_wrap(~FDI)+theme(legend.position = "bottom",legend.direction="vertical")
```

North work suggest that institutions and governance also impact the GDP. 
To study this impact, we can compute a composite indicator by doing the mean of the percentile rank of the six dimensions of governance measured by the World Bank and see its relationship with the GDP per capita PPP. 
```{r}
# Gathering of the governance variables according to their categories
govc.percentile.rank <- global_df%>% dplyr::select(ends_with("Percentile Rank"))
govc.estimate <- global_df%>% dplyr::select(ends_with("Estimate"))
govc.pr.lower.bound <- global_df%>% dplyr::select(contains("Lower"))
govc.pr.upper.bound <- global_df%>% dplyr::select(contains("Upper"))
# Computation of an composite indicator data frame by computing the mean of the percentile rank of each variable and the upper and lower bound of the 90% confidence interval of this rank.
govc.IC.percentile.rank <- as.data.frame(rowMeans(govc.percentile.rank))
IC.df <-govc.IC.percentile.rank %>% mutate(govc.IC.lower.bound = (rowMeans(govc.pr.lower.bound))) %>% mutate(govc.IC.upper.bound = (rowMeans(govc.pr.upper.bound))) %>% mutate(govc.IC.percentile.rank = (rowMeans(govc.percentile.rank))) %>% dplyr::select(-`rowMeans(govc.percentile.rank)`) 
# computation of the graphical representation of the correlation
IC.df %>% mutate(`GDP per capita growth (annual %)`= global_df$`GDP per capita growth (annual %)`) %>% pivot_longer(cols = starts_with("govc"), names_to = "govc.IC", values_to = "govc.IC.value") %>%
ggplot(aes(x =`GDP per capita growth (annual %)`,y = `govc.IC.value`, group = govc.IC)) + geom_point(aes(color = govc.IC,alpha=0.5))+ theme(legend.position = "bottom",legend.direction="vertical")+geom_smooth(method = "lm", se = FALSE, aes(color = govc.IC))
```
Even individually, each dimension seems to be positively correlated with the economic growth, except the Political stability and absence of violence and terrorism.
```{r}
govc.percentile.rank %>% mutate(`GDP per capita growth (annual %)`= global_df$`GDP per capita growth (annual %)`) %>% pivot_longer(cols = ends_with("Percentile Rank"), names_to = "Dimensions", values_to = "Percentile Rank") %>%
ggplot(aes(x =`GDP per capita growth (annual %)`,y = `Percentile Rank`, group = Dimensions)) + theme(legend.position = "bottom",legend.direction="vertical")+geom_point(aes(color = Dimensions))+geom_smooth(method = "lm", se = FALSE, col = "black")+facet_wrap(~Dimensions)
```
Economists discuss the relevance of GDP to indicate well-being.

## IV) Conclusion

## V) Annex (data import work and sources)

#### Data import work :
Here are the few steps to compute the global data frame used in this study :
First both data sets are loaded, we make sure that ".." is perceived as NA.
We check that the type of each of the column with values is double, and make the change necessary for the values'column of the development data set for which it was not the case.
Then the rows containing data of countries present in both data frame are selected.
In order to have a variable column with less NA, we compute the mean of those three columns.
We then select the indicators for which there is more than 25% of NA. 
Finally, the joining of the two data sets : we pivot them to get their wide version, and do an inner join.
Once they are joined, we pivot again the global data frame we just obtained to have its longer form.

The code of this preparation work is visible at the beginning of the quarto file corresponding to this report. A longer and more detailed version of it is also available in the "project_goal&data_description" quarto file present in the github repository of this project : [github-repository](https://github.com/E10is3/final-project.git)

#### Sources :
The data I use come from two open source data sets of the World Bank. 
The first one includes governance indicators available via this link : [WorldBank-governance-indicators](https://databank.worldbank.org/source/worldwide-governance-indicators#)
Please note that the ticked options are the preset ones by the website and not the ones I will use. To get the exact same .csv file, select all the 214 countries available, the years 2020, 2021 and 2022, and all the 36 variable series before the download.
The second data set includes development indicators, available via this link : [WorldBank-development-indicators](https://databank.worldbank.org/source/world-development-indicators#)
To get the exact same .csv file, select all the 266 countries available, the years 2020, 2021 and 2022. I first selected `r NROW(dvpt_codes)` variable series but kept only `r NROW(keep.dvpt.indicator)-1` of them, since the other three provided data for less than 75% of the countries of the final sample. Here is the list of those `r NROW(keep.dvpt.indicator)-1` variables series :
```{r}
#| message: false
print(keep.dvpt.indicator)
```













